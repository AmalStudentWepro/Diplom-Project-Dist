import{a as u,h as E,f as $}from"./footer-CviQuUYY.js";import"./helpers-9Lo3EvBV.js";import"./index-DVUMKYbu.js";function h(o,a,n){a.innerHTML="",o.forEach(l=>{a.append(n(l))})}function v(o){var s;const a=document.createElement("div");a.className="movie-card",a.dataset.id=o.id;const n=document.createElement("img");n.src=`https://image.tmdb.org/t/p/w500${o.poster_path}`,n.alt=o.title,a.appendChild(n);const l=document.createElement("h3");l.textContent=o.title,a.appendChild(l);const i=document.createElement("div");return i.className="movie-rating",i.textContent=((s=o.vote_average)==null?void 0:s.toFixed(1))||"-",a.appendChild(i),a.onmouseenter=()=>{const r=document.querySelector(".dynamic-bg");o.backdrop_path?r.style.backgroundImage=`url(https://image.tmdb.org/t/p/original${o.backdrop_path})`:r.style.backgroundImage="url('/public/fallback.jpg')"},a.onclick=()=>{window.location.href=`/src/pages/movie/index.html?id=${o.id}`},a}let f=["https://www.youtube.com/embed/tTQIF3VwIwI","https://www.youtube.com/embed/mc93fO8ub8M?si=An5u8CcqQEl5OOSc","https://www.youtube.com/embed/UUsgZEySv5k?si=Lfxpii-5LvdMFdXe","https://www.youtube.com/embed/5PSNL1qE6VY","https://www.youtube.com/embed/PMeHdc25BGE?si=TtAqh1jaetHKHEFe"];function x(o){const a=document.createElement("div"),n=document.createElement("img"),l=document.createElement("p");return a.className="trailer-card",n.src=`https://image.tmdb.org/t/p/w500${o.backdrop_path}`,n.alt=o.title,l.textContent=o.title,a.append(n,l),a.onclick=()=>{const i=document.querySelector(".trailer");u.get(`/movie/${o.id}/videos`).then(s=>{const r=s.data.results||[];let t=r.find(e=>e.type.toLowerCase()==="trailer");if(t||(t=r.find(e=>e.type.toLowerCase()==="teaser")),!t&&r.length>0&&(t=r[0]),t&&t.site.toLowerCase()==="youtube"&&t.key)i.src=`https://www.youtube.com/embed/${t.key}`;else{const e=f[Math.floor(Math.random()*f.length)];i.src=e}}).catch(s=>{console.error(s);const r=f[Math.floor(Math.random()*f.length)];i.src=r})},a}function S(o){let a=document.createElement("div");a.textContent=o.name;const n=document.querySelector(".now_playing");return a.onclick=()=>{console.log(o),u.get(`/discover/movie?with_genres=${o.id}`).then(l=>{h(l.data.results.slice(0,8),n,v)})},a}function q(){const o=document.querySelector(".search-btn"),a=document.querySelector(".close-modal"),n=document.querySelector(".search-modal"),l=n.querySelector("input"),i=n.querySelector(".search-submit"),s=n.querySelector(".search-modal-content");s.style.display="flex",s.style.flexDirection="column",s.style.alignItems="stretch",s.style.gap="10px",s.style.width="100%",n.style.alignItems="flex-start",n.style.paddingTop="120px";const r=document.createElement("div");r.style.display="flex",r.style.gap="10px",r.style.width="100%",r.appendChild(l),r.appendChild(i),s.innerHTML="",s.appendChild(r);const t=document.createElement("div");t.className="search-tabs",t.style.display="flex",t.style.justifyContent="center",t.style.position="relative",t.style.gap="20px",t.style.marginTop="5px",t.style.width="100%",t.innerHTML=`
    <button data-type="movie" class="active">Фильмы</button>
    <button data-type="tv">Сериалы</button>
    <button data-type="person">Персоны</button>
    <div class="tab-underline" style="
      position:absolute;
      bottom:0;
      left:0;
      height:2px;
      background:#e7ff1e;
      transition: all 0.3s ease;"></div>
  `,s.appendChild(t);const e=document.createElement("div");e.style.display="flex",e.style.flexDirection="column",e.style.gap="8px",e.style.maxHeight="400px",e.style.overflowY="auto",e.style.width="100%",s.appendChild(e),o.onclick=()=>{n.classList.add("active"),l.value="",e.innerHTML="",l.focus(),g()},a.onclick=()=>{n.classList.remove("active")};let m,d="movie";const y=t.querySelectorAll("button"),C=t.querySelector(".tab-underline");function g(){const p=t.querySelector(".active");C.style.width=p.offsetWidth+"px",C.style.left=p.offsetLeft+"px"}y.forEach(p=>{p.onclick=()=>{y.forEach(c=>c.classList.remove("active")),p.classList.add("active"),d=p.dataset.type,g(),l.value.trim()&&w(l.value.trim())}}),window.addEventListener("resize",g),g(),l.onkeyup=p=>{const c=l.value.trim();if(!c){e.innerHTML="";return}if(p.key==="Enter"){w(c);return}clearTimeout(m),m=setTimeout(()=>{w(c)},500)};async function w(p){e.innerHTML="<p style='color:white'>Загрузка...</p>";try{const c=await api.get(`/search/${d}`,{params:{query:p}});L(c.data.results)}catch(c){console.error(c),e.innerHTML="<p style='color:white'>Ошибка при поиске</p>"}}function L(p){if(e.innerHTML="",!p||p.length===0){e.innerHTML="<p style='color:white'>Ничего не найдено.</p>";return}p.forEach(c=>{const b=document.createElement("div");b.className="result-item",b.innerHTML=`
      <img src="https://image.tmdb.org/t/p/w92${c.poster_path||c.profile_path}" alt="">
      <div>
        <strong>${c.title||c.name}</strong>
        <p>${c.release_date||c.first_air_date||""}</p>
      </div>
      ${c.vote_average?`<span>${c.vote_average.toFixed(1)}</span>`:""}
    `,e.appendChild(b)})}}async function k(o=".persons-wrapper"){const a=document.querySelector(o);if(a)try{const{data:n}=await u.get("/person/popular",{params:{language:"ru-RU"}}),l=n.results.slice(0,6),i=await Promise.all(l.map(async e=>{const{data:m}=await u.get(`/person/${e.id}`,{params:{language:"ru-RU"}}),d=m.birthday?new Date(m.birthday).getFullYear():null,y=d?`${new Date().getFullYear()-d} лет`:"—";return{id:e.id,name:e.name,originalName:m.name!==e.name?m.name:"",age:y,profile:e.profile_path?`https://image.tmdb.org/t/p/w500${e.profile_path}`:"/public/placeholder.jpg"}}));a.innerHTML="";const s=document.createElement("div");s.className="top-persons",i.slice(0,2).forEach((e,m)=>{const d=document.createElement("div");d.className="person",d.innerHTML=`
        <span class="rank">${m+1}-е место</span>
        <img src="${e.profile}" alt="${e.name}">
        <div class="person-info">
          <p class="name">${e.name}</p>
          <p class="original-name">${e.originalName}</p>
          <p class="age">${e.age}</p>
        </div>
      `,d.onclick=()=>{window.location.href=`/src/pages/actor/index.html?id=${e.id}`},s.appendChild(d)});const r=document.createElement("div");r.className="persons-list";const t=document.createElement("ul");t.className="ul",i.slice(2).forEach((e,m)=>{const d=document.createElement("li");d.innerHTML=`
        <div class="list-info">
          <p class="others-name">${e.name}</p>
          <p class="org-name">${e.originalName}</p>
          <p class="age">${e.age}</p>
        </div>
        <span class="place">${m+3}-е место</span>
      `,d.onclick=()=>{window.location.href=`/src/pages/actor/index.html?id=${e.id}`},t.appendChild(d)}),r.appendChild(t),a.appendChild(s),a.appendChild(r)}catch(n){console.error("Ошибка загрузки персон:",n)}}document.body.prepend(E());document.body.append($());document.addEventListener("DOMContentLoaded",()=>{q()});k();const M=document.querySelector(".now_playing"),T=document.querySelector(".popular-films .movies-grid"),_=document.querySelector(".coming-soon .movies-grid"),H=document.querySelector(".filters-nav"),N=document.querySelector(".trailers-grid");let F=u.get("/movie/now_playing"),I=u.get("/movie/popular"),P=u.get("/movie/upcoming"),U=u.get("/genre/movie/list");Promise.all([F,I,P,U]).then(([o,a,n,l])=>{h(o.data.results.slice(0,8),M,v),h(a.data.results.slice(0,4),T,v),h(n.data.results.slice(0,4),_,v),h(n.data.results.slice(0,12),N,x),h(l.data.genres.slice(0,6),H,S);const i=n.data.results[0];i&&u.get(`/movie/${i.id}/videos`).then(s=>{const r=s.data.results;if(!r||r.length===0){console.warn("Вообще нет видео");return}let t=r.find(e=>e.type.toLowerCase()==="trailer");if(t||(t=r.find(e=>e.type.toLowerCase()==="teaser")),!t&&r.length>0&&(t=r[0]),t&&t.site.toLowerCase()==="youtube"&&t.key){const e=document.querySelector(".trailer");e.src=`https://www.youtube.com/embed/${t.key}`}else console.warn("Видео не найдено")}).catch(s=>console.error(s))}).catch(o=>console.error(o));document.querySelector(".search-btn").onclick=()=>{document.querySelector(".search-modal").classList.add("active")};document.querySelector(".close-modal").onclick=()=>{document.querySelector(".search-modal").classList.remove("active")};
